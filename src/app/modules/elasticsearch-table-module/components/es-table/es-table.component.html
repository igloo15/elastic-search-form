<div class="table-outline">
    <div class="top-container">
        <mat-form-field *ngIf="config.showSearch" class="search-width">
            <mat-label>Search</mat-label>
            <input matInput (keyup)="searchTextUpdate.next($event)" >
        </mat-form-field>
        <mat-form-field *ngIf="config.showLimitDropDown">
            <mat-label>Item Limit</mat-label>
            <mat-select [(value)]="config.limit">
                <mat-option *ngFor="let item of limits" [value]="item">{{item}}</mat-option>
            </mat-select>
        </mat-form-field>
        
        <div class="spacer"></div>
        <button mat-mini-fab color="primary" (click)="scrollUpOrDown(bottomButton)" class="button-margins" *ngIf="config.showDownArrow" #topButton>
            <mat-icon>arrow_downward</mat-icon>
        </button>
        <button mat-mini-fab color="primary" (click)="refreshData()" class="button-margins" *ngIf="config.showRefresh">
            <mat-icon>refresh</mat-icon>
        </button>
        <button mat-mini-fab color="primary" (click)="openConfig()" class="button-margins" *ngIf="config.showConfigButton">
            <mat-icon>settings</mat-icon>
        </button>
        
    </div>
    <ngx-datatable 
        #esTable
        [rows]="rows" 
        [columns]="columns" 
        [columnMode]="ColumnMode.standard"
        [reorderable]="true"
        [loadingIndicator]="loading"
        [headerHeight]="50"
        [footerHeight]="50"
        [rowHeight]="'auto'"
        [count]="config.totalCount" 
        [externalPaging]="true"
        [externalSorting]="true"
        [offset]="config.offset" 
        [limit]="config.limit" 
        [swapColumns]="true"
        [scrollbarH]="config.scrollbarH"
        [scrollbarV]="config.scrollbarV"
        (page)="setPage($event)"
        (sort)="onSort($event)"
        class="material">
        <!-- Row Detail Template -->
        <ngx-datatable-row-detail [rowHeight]="'auto'" #myDetailRow>
            <ng-template let-row="row" let-expanded="expanded" ngx-datatable-row-detail-template>
                <ngx-json-viewer [json]="row" [expanded]="false"></ngx-json-viewer>
            </ng-template>
        </ngx-datatable-row-detail>
    </ngx-datatable>

    <ng-template #basicTmpl let-row="row" let-value="value">
        <ng-container *ngIf="isArray(value)">
            <mat-chip-list>
                <mat-chip *ngFor="let item of value">{{item}}</mat-chip>
            </mat-chip-list>
        </ng-container>
        <ng-container *ngIf="!isArray(value)">
            {{value}}
        </ng-container>
    </ng-template>

    <ng-template #expandTmpl let-row="row" let-expanded="expanded" ngx-datatable-cell-template>
        <span
            href="javascript:void(0)"
            [class.datatable-icon-right]="!expanded"
            [class.datatable-icon-down]="expanded"
            title="Expand/Collapse Row"
            (click)="toggleExpandRow(row)"
        >
        </span>
    </ng-template>

    <ng-template #arrayTmpl let-row="row" let-value="value">
        <mat-chip-list>
            <mat-chip *ngFor="let item of value">{{item}}</mat-chip>
        </mat-chip-list>
    </ng-template>

    <ng-template #objTmpl let-row="row" let-value="value">
        <ngx-json-viewer [json]="value" [expanded]="false"></ngx-json-viewer>
    </ng-template>

    <ng-template #linkTmpl let-row="row" let-value="value" let-column="column">
        <button mat-raised-button [routerLink]="documentRoute(row, value, column)" routerLinkActive="router-link-active">{{column.name}}</button>
    </ng-template>
    <div class="bottom-container">
        <button mat-mini-fab color="primary" (click)="scrollUpOrDown(topButton)" class="button-margins" *ngIf="config.showUpArrow" #bottomButton>
            <mat-icon>arrow_upward</mat-icon>
        </button>
    </div>
</div>